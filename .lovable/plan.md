

# ุฎุทุฉ ุชูุนูู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู: ุฅุดุนุงุฑุงุช ุงูุฑุณุงุฆู + ุงุณุชุนุงุฏุฉ ูููุฉ ุงููุฑูุฑ

## ููุฎุต
ุงูููู `mail.php` ุงูุฐู ุฑูุนุชู ูุญุชูู ุนูู ูู ุงูุฏูุงู ุงููุงุฒูุฉ ููููู ุงุณุชุฎุฏุงูู ูุจุงุดุฑุฉ!

---

## ุงูููุงู ุงููุทููุจุฉ

### ุงููููุฉ 1: ุฅูุดุงุก ููู ุงูุฅุนุฏุงุฏุงุช ุงูููุญุฏ

**ููู ุฌุฏูุฏ:** `php-api/config/config.php`

**ุงููุญุชูู:**
```text
ุฅุนุฏุงุฏุงุช ุงููููุน:
- SITE_URL = 'https://aws.sa'
- SITE_NAME_AR = 'ูุญุทุงุช ุงูุณ'

ุฅุนุฏุงุฏุงุช ุงูุจุฑูุฏ (SMTP):
- SMTP_ENABLED = true
- SMTP_HOST = 'smtp.hostinger.com'
- SMTP_PORT = 465
- SMTP_SECURE = 'ssl'
- SMTP_USER = 'noreply@aws.sa' โ ุชุญุชุงุฌ ุฅูุดุงุกู
- SMTP_PASS = 'ูููุฉ ุงููุฑูุฑ' โ ุชุญุชุงุฌ ุชุนุจุฆุชู
- SMTP_FROM = 'noreply@aws.sa'
- SMTP_FROM_NAME = 'ูุญุทุงุช ุงูุณ'
- ADMIN_EMAIL = 'info@aws.sa' โ ุงูุจุฑูุฏ ุงููุณุชูู ููุฅุดุนุงุฑุงุช

ุฏุงูุฉ getSetting():
- ูุฌูุจ ุงูุฅุนุฏุงุฏุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
```

---

### ุงููููุฉ 2: ูุณุฎ ููู ุงูุจุฑูุฏ

**ูุณุฎ:** `user-uploads://mail.php` โ `php-api/config/mail.php`

**ุงูุฏูุงู ุงููุชููุฑุฉ:**
| ุงูุฏุงูุฉ | ุงูุงุณุชุฎุฏุงู |
|--------|-----------|
| `sendEmail()` | ุฅุฑุณุงู ุฃู ุจุฑูุฏ |
| `notifyNewMessage()` | ุฅุดุนุงุฑ ุงูุฅุฏุงุฑุฉ ุจุฑุณุงูุฉ ุฌุฏูุฏุฉ |
| `sendMessageReply()` | ุงูุฑุฏ ุนูู ุฑุณุงุฆู ุงูุนููุงุก |
| `getEmailTemplate()` | ูุงูุจ ุงูุจุฑูุฏ ุงูุงุญุชุฑุงูู |

---

### ุงููููุฉ 3: ุชุญุฏูุซ messages/create.php

**ุงูููู:** `php-api/messages/create.php`

**ุงูุชุนุฏูู:**
```text
ุจุนุฏ ุญูุธ ุงูุฑุณุงูุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช:
1. ุงุณุชุฏุนุงุก require_once '../config/mail.php'
2. ุงุณุชุฏุนุงุก notifyNewMessage($message)
3. ุฅุฑุณุงู ุจุฑูุฏ ููุฅุฏุงุฑุฉ ุชููุงุฆูุงู
```

**ุงููุชูุฌุฉ:** ุนูุฏ ุฅุฑุณุงู ุฃู ุฑุณุงูุฉ ูู ูููุฐุฌ ุงูุชูุงุตูุ ุณูุตูู ุฅุดุนุงุฑ ููุฑู ุนูู ุจุฑูุฏู!

---

### ุงููููุฉ 4: ุฅูุดุงุก forgot-password.php

**ููู ุฌุฏูุฏ:** `php-api/auth/forgot-password.php`

**ุงูููุทู:**
```text
1. ุงุณุชูุจุงู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูู ุงููุณุชุฎุฏู
2. ุงูุจุญุซ ุนู ุงููุณุชุฎุฏู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
3. ุฅูุดุงุก token ุนุดูุงุฆู (64 ุญุฑู)
4. ุญูุธ ุงูู token ูู ุฌุฏูู password_reset_tokens
5. ุฅุฑุณุงู ุจุฑูุฏ ูุญุชูู ุฑุงุจุท ุฅุนุงุฏุฉ ุงูุชุนููู:
   https://aws.sa/reset-password?token=xxxxx
6. ุตูุงุญูุฉ ุงูุฑุงุจุท: ุณุงุนุฉ ูุงุญุฏุฉ
```

**ูุงูุจ ุงูุจุฑูุฏ:**
```text
ุนููุงู: ุฅุนุงุฏุฉ ุชุนููู ูููุฉ ุงููุฑูุฑ

ูุฑุญุจุงู [ุงูุงุณู]ุ

ุชู ุทูุจ ุฅุนุงุฏุฉ ุชุนููู ูููุฉ ุงููุฑูุฑ ูุญุณุงุจู.

[ุฒุฑ: ุฅุนุงุฏุฉ ุชุนููู ูููุฉ ุงููุฑูุฑ]

ุงูุฑุงุจุท ุตุงูุญ ููุฏุฉ ุณุงุนุฉ ูุงุญุฏุฉ.
ุฅุฐุง ูู ุชุทูุจ ุฐููุ ุชุฌุงูู ูุฐู ุงูุฑุณุงูุฉ.
```

---

### ุงููููุฉ 5: ุฅูุดุงุก reset-password-verify.php

**ููู ุฌุฏูุฏ:** `php-api/auth/reset-password-verify.php`

**ุงูููุทู:**
```text
1. ุงุณุชูุจุงู token + ูููุฉ ุงููุฑูุฑ ุงูุฌุฏูุฏุฉ
2. ุงูุชุญูู ูู ุตูุงุญูุฉ ุงูู token (ููุฌูุฏ + ูู ุชูุชูู ุตูุงุญูุชู)
3. ุชุญุฏูุซ ูููุฉ ุงููุฑูุฑ ูู ุฌุฏูู users
4. ุญุฐู ุงูู token
5. ุฅุฑุณุงู ุฑุณุงูุฉ ูุฌุงุญ
```

---

### ุงููููุฉ 6: ุชุญุฏูุซ database.sql

**ุฅุถุงูุฉ ุฌุฏูู:** `password_reset_tokens`

```sql
CREATE TABLE password_reset_tokens (
    id VARCHAR(36) PRIMARY KEY,
    user_id VARCHAR(36) NOT NULL,
    token VARCHAR(64) NOT NULL UNIQUE,
    expires_at TIMESTAMP NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
);
```

---

## ูููู ุงููููุงุช ุงูููุงุฆู

```text
php-api/
โโโ config/
โ   โโโ config.php      โ ุฌุฏูุฏ (ุงูุฅุนุฏุงุฏุงุช ุงูููุญุฏุฉ)
โ   โโโ database.php    โ ููุฌูุฏ (ูุณุชุฏุนู config.php)
โ   โโโ mail.php        โ ุฌุฏูุฏ (ูููู ุงููุฑููุน)
โโโ vendor/
โ   โโโ PHPMailer/      โ ูุฌุจ ุฑูุนู ูู GitHub
โ       โโโ src/
โ           โโโ PHPMailer.php
โ           โโโ SMTP.php
โ           โโโ Exception.php
โโโ auth/
โ   โโโ login.php
โ   โโโ logout.php
โ   โโโ check-session.php
โ   โโโ change-password.php
โ   โโโ forgot-password.php      โ ุฌุฏูุฏ
โ   โโโ reset-password-verify.php โ ุฌุฏูุฏ
โโโ messages/
    โโโ create.php       โ ุชุนุฏูู (ุฅุถุงูุฉ ุฅุดุนุงุฑ ุงูุจุฑูุฏ)
```

---

## ููุฎุต ุงููููุงุช

### ูููุงุช ุฌุฏูุฏุฉ:
| ุงูููู | ุงูุบุฑุถ |
|-------|-------|
| `php-api/config/config.php` | ุฅุนุฏุงุฏุงุช ุงููููุน + SMTP |
| `php-api/config/mail.php` | ุฏูุงู ุฅุฑุณุงู ุงูุจุฑูุฏ |
| `php-api/auth/forgot-password.php` | ุทูุจ ุงุณุชุนุงุฏุฉ ูููุฉ ุงููุฑูุฑ |
| `php-api/auth/reset-password-verify.php` | ุชูููุฐ ุฅุนุงุฏุฉ ุงูุชุนููู |

### ูููุงุช ุชูุนุฏูู:
| ุงูููู | ุงูุชุนุฏูู |
|-------|---------|
| `php-api/messages/create.php` | ุฅุถุงูุฉ ุงุณุชุฏุนุงุก `notifyNewMessage()` |
| `php-api/database.sql` | ุฅุถุงูุฉ ุฌุฏูู `password_reset_tokens` |

---

## ุฎุทูุงุช ุงูุฅุนุฏุงุฏ ุนูู Hostinger

### ุงูุฎุทูุฉ 1: ุฅูุดุงุก ุญุณุงุจ ุจุฑูุฏ
```text
1. ุงุฏุฎู ููุญุฉ ุชุญูู Hostinger
2. ุงุฐูุจ ุฅูู Emails โ Email Accounts
3. ุฃูุดุฆ ุญุณุงุจ: noreply@aws.sa
4. ุงุญูุธ ูููุฉ ุงููุฑูุฑ
```

### ุงูุฎุทูุฉ 2: ุฑูุน PHPMailer
```text
1. ุญููู ูู: https://github.com/PHPMailer/PHPMailer/releases
2. ูู ุงูุถุบุท
3. ุงุฑูุน ูุฌูุฏ src ุฅูู: public_html/api/vendor/PHPMailer/src/
```

### ุงูุฎุทูุฉ 3: ุชุนุฏูู ุงูุฅุนุฏุงุฏุงุช
```text
1. ุงูุชุญ api/config/config.php
2. ุนุฏูู SMTP_PASS ุจูููุฉ ูุฑูุฑ ุงูุจุฑูุฏ
3. ุชุฃูุฏ ูู ADMIN_EMAIL (ุงูุจุฑูุฏ ุงููุณุชูู ููุฅุดุนุงุฑุงุช)
```

### ุงูุฎุทูุฉ 4: ุงุฎุชุจุงุฑ
```text
1. ุฃุฑุณู ุฑุณุงูุฉ ุชุฌุฑูุจูุฉ ูู ูููุฐุฌ ุงูุชูุงุตู
2. ุชุญูู ูู ูุตูู ุงูุฅุดุนุงุฑ ุฅูู info@aws.sa
3. ุฌุฑุจ "ูุณูุช ูููุฉ ุงููุฑูุฑ" ูุชุญูู ูู ุงูุจุฑูุฏ
```

---

## ูุซุงู ุนูู ุงูุจุฑูุฏ ุงูุฐู ุณูุตูู

ุนูุฏ ูุตูู ุฑุณุงูุฉ ุฌุฏูุฏุฉ ูู ุงููููุนุ ุณูุตูู ุจุฑูุฏ ุจูุฐุง ุงูุดูู:

```text
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  [ุดุนุงุฑ ุงูุณ]                            โ
โ  ูุญุทุงุช ุงูุณ                             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                        โ
โ  ๐ฉ ุฑุณุงูุฉ ุฌุฏูุฏุฉ ูู ุงููููุน              โ
โ                                        โ
โ  ุงูุงุณู: ูุญูุฏ ุฃุญูุฏ                      โ
โ  ุงูุจุฑูุฏ: mohamed@example.com           โ
โ  ุงููุงุชู: 0551234567                    โ
โ  ุงูููุน: ุงุณุชูุณุงุฑ ุนุงู                    โ
โ  ุงูุฑุณุงูุฉ: ุฃุฑูุฏ ุงูุงุณุชูุณุงุฑ ุนู...         โ
โ                                        โ
โ  [ุนุฑุถ ูู ููุญุฉ ุงูุชุญูู]                  โ
โ                                        โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ  ูุญุทุงุช ุงูุณ - ุดุฑููู ุงูููุซูู ููุฐ 1998    โ
โ  ูุงุชู: 920008436 | info@aws.sa         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ููุงุญุธุฉ ูููุฉ

ููู `mail.php` ุงูุฐู ุฑูุนุชู ูุณุชุฎุฏู ุฏุงูุฉ `getSetting()` ูุฌูุจ ุงูุฅุนุฏุงุฏุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช. ุณุฃุถูู ูุฐู ุงูุฏุงูุฉ ูู ููู `config.php` ููุชูุงูู ูุน ุฌุฏูู `site_settings` ุงูุฐู ุฃูุดุฃูุงู ุณุงุจูุงู.

