
# ุฎุทุฉ ุงูุชุญููู ุงูุดุงูู: ุฅุฒุงูุฉ Supabase + ุชุณุฌูู ุงูุฏุฎูู ุจุงุณู ุงููุณุชุฎุฏู + ุฅุฑุณุงู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู

## ููุฎุต ุงูุชุนุฏููุงุช ุงูุฅุถุงููุฉ
ุจูุงุกู ุนูู ุทูุจูุ ุณูุชู ุชุนุฏูู ูุธุงู ุงููุตุงุฏูุฉ ููุนูู ุจู:
- **ุงุณู ุงููุณุชุฎุฏู** ูุชุณุฌูู ุงูุฏุฎูู (ุจุฏูุงู ูู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู)
- **ุงูุจุฑูุฏ ุงูุฅููุชุฑููู** ูุงุณุชุนุงุฏุฉ ูููุฉ ุงููุฑูุฑ ููุท
- **ุฅุฑุณุงู ุจุฑูุฏ ุฅููุชุฑููู ูุนูู** ุนูุฏ ุทูุจ ุงุณุชุนุงุฏุฉ ูููุฉ ุงููุฑูุฑ

---

## ุงูููุงู ุงูุฑุฆูุณูุฉ

### ุงููุฑุญูุฉ 1: ุชุจุณูุท API Client ูุฅุฒุงูุฉ Supabase

**ุงูููู:** `src/lib/api.ts`

**ุงูุชุบููุฑุงุช:**
```text
ูุจู:
  - ูุดู ุชููุงุฆู ููุจูุฆุฉ (Lovable/Production)
  - ูุชุบูุฑ USE_SUPABASE ููุชุจุฏูู
  
ุจุนุฏ:
  - API_BASE_URL = "/api" ููุท
  - ุฅุฒุงูุฉ USE_SUPABASE ููุงุฆูุงู
```

---

### ุงููุฑุญูุฉ 2: ุชุญุฏูุซ ุฌุฏูู ุงููุณุชุฎุฏููู ูู MySQL

**ุงูููู:** `php-api/database.sql`

**ุชุญุฏูุซ ุฌุฏูู users:**
```text
ุฅุถุงูุฉ ุนููุฏ username ูุจุงุดุฑุฉ ูู ุฌุฏูู users ุจุฏูุงู ูู ุงูุงุนุชูุงุฏ ุนูู profiles
- username VARCHAR(50) NOT NULL UNIQUE
- ุฅุถุงูุฉ ุฌุฏูู password_reset_tokens ูุชุฎุฒูู ุฑููุฒ ุฅุนุงุฏุฉ ุงูุชุนููู
```

**ุฌุฏูู ุฌุฏูุฏ:** `password_reset_tokens`
```text
- id VARCHAR(36)
- user_id VARCHAR(36) 
- token VARCHAR(64) - ุฑูุฒ ูุฑูุฏ ููุชุญูู
- expires_at TIMESTAMP - ุตูุงุญูุฉ 1 ุณุงุนุฉ
- created_at TIMESTAMP
```

---

### ุงููุฑุญูุฉ 3: ุชุนุฏูู ุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู

**ุงูููู:** `src/pages/AdminLogin.tsx`

**ุงูุชุบููุฑุงุช:**
- ุฅุฒุงูุฉ ูู imports ูู Supabase
- ุชุบููุฑ ุงูุญูู ูู "ุงูุจุฑูุฏ ุงูุฅููุชุฑููู" ุฅูู "ุงุณู ุงููุณุชุฎุฏู"
- ุงุณุชุฎุฏุงู `signIn` ูู AuthContext ูุน username ุจุฏูุงู ูู email
- ุชุญุฏูุซ ุฑุณุงุฆู ุงูุฎุทุฃ

**ุงููุงุฌูุฉ ุงูุฌุฏูุฏุฉ:**
```text
+-----------------------------------+
|      ุงุณู ุงููุณุชุฎุฏู                 |
|  [___________________]  ๐ค        |
|                                   |
|      ูููุฉ ุงููุฑูุฑ                  |
|  [___________________]  ๐        |
|                                   |
|  [ุชุณุฌูู ุงูุฏุฎูู]                   |
|                                   |
|  ูุณูุช ูููุฉ ุงููุฑูุฑุ                |
+-----------------------------------+
```

---

### ุงููุฑุญูุฉ 4: ุชุญุฏูุซ AuthContext

**ุงูููู:** `src/contexts/AuthContext.tsx`

**ุงูุชุบููุฑุงุช:**
- ุชุบููุฑ `signIn(email, password)` ุฅูู `signIn(username, password)`
- ุชุญุฏูุซ LoginResponse ููุดูู username

**ุงูููู:** `src/types/api.ts`

**ุงูุชุบููุฑุงุช:**
```text
interface User {
  id: string;
  username: string;  // ุฅุถุงูุฉ
  email: string;
  role: "admin" | "editor";
}
```

---

### ุงููุฑุญูุฉ 5: ุชุญุฏูุซ PHP Login API

**ุงูููู:** `php-api/auth/login.php`

**ุงูุชุบููุฑุงุช:**
```text
ูุจู:
  WHERE u.email = ?

ุจุนุฏ:
  WHERE u.username = ?
```

---

### ุงููุฑุญูุฉ 6: ุฅูุดุงุก ูุธุงู ุงุณุชุนุงุฏุฉ ูููุฉ ุงููุฑูุฑ ุจุงูุจุฑูุฏ

**ุงููููุงุช ุงูุฌุฏูุฏุฉ:**

**1. `php-api/auth/forgot-password.php`**
```text
ุงูููุทู:
1. ูุณุชูุจู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
2. ูุจุญุซ ุนู ุงููุณุชุฎุฏู ุจุงูุจุฑูุฏ
3. ูููุดุฆ ุฑูุฒ token ุนุดูุงุฆู
4. ูุญูุธู ูู ุฌุฏูู password_reset_tokens
5. ูุฑุณู ุจุฑูุฏ ุฅููุชุฑููู ูุญุชูู ุนูู ุฑุงุจุท ุฅุนุงุฏุฉ ุงูุชุนููู
```

**2. `php-api/auth/reset-password-verify.php`**
```text
ุงูููุทู:
1. ูุณุชูุจู token ู password ุงูุฌุฏูุฏุฉ
2. ูุชุญูู ูู ุตูุงุญูุฉ ุงูู token
3. ูุญุฏุซ ูููุฉ ุงููุฑูุฑ
4. ูุญุฐู ุงูู token
```

**3. ุฅุนุฏุงุฏ ุฅุฑุณุงู ุงูุจุฑูุฏ:**
```text
ุฎูุงุฑุงุช ุงูุฅุฑุณุงู ุงููุชุงุญุฉ:
- PHPMailer ูุน SMTP (Gmail, Hostinger Mail, etc.)
- Hostinger built-in mail()
- Resend API (ูุญุชุงุฌ ููุชุงุญ API)

ุณูุณุชุฎุฏู: PHPMailer ูุน SMTP ูุฃูู ุงูุฃูุซุฑ ููุซูููุฉ
```

---

### ุงููุฑุญูุฉ 7: ุชุญุฏูุซ ุตูุญุงุช ุงุณุชุนุงุฏุฉ ูููุฉ ุงููุฑูุฑ

**ุงูููู:** `src/pages/ForgotPassword.tsx`

**ุงูุชุบููุฑุงุช:**
- ุฅุฒุงูุฉ Supabase imports
- ุงุณุชุฎุฏุงู `api.post("/auth/forgot-password.php")`
- ุฅุถุงูุฉ ุฑุณุงูุฉ ูุฌุงุญ ูุงุถุญุฉ

**ุงูููู:** `src/pages/ResetPassword.tsx`

**ุงูุชุบููุฑุงุช:**
- ุฅุฒุงูุฉ Supabase imports
- ูุฑุงุกุฉ token ูู URL parameters
- ุงุณุชุฎุฏุงู `api.post("/auth/reset-password-verify.php")`

---

### ุงููุฑุญูุฉ 8: ุชุญููู ูู Sections ููุตูุญุฉ ุงูุฑุฆูุณูุฉ

**ุงููููุงุช ุงููุชุฃุซุฑุฉ:**

| ุงูููู | ุงูุชุบููุฑ |
|-------|---------|
| `Hero.tsx` | ุฅุฒุงูุฉ USE_SUPABASEุ ุงุณุชุฎุฏุงู api.get ููุท |
| `About.tsx` | ุฅุฒุงูุฉ USE_SUPABASEุ ุงุณุชุฎุฏุงู api.get ููุท |
| `Services.tsx` | ุฅุฒุงูุฉ USE_SUPABASEุ ุงุณุชุฎุฏุงู api.get ููุท |
| `Stations.tsx` | ุฅุฒุงูุฉ USE_SUPABASEุ ุงุณุชุฎุฏุงู api.get ููุท |
| `Partners.tsx` | ุฅุฒุงูุฉ USE_SUPABASEุ ุงุณุชุฎุฏุงู api.get ููุท |
| `Contact.tsx` | ุฅุฒุงูุฉ USE_SUPABASEุ ุงุณุชุฎุฏุงู api.post ููุท |

**ููุท ุงูุชุบููุฑ ุงูููุญุฏ:**
```text
ูุจู:
  if (USE_SUPABASE) {
    const { data } = await supabase.from("table")...
  } else {
    return api.get("/endpoint.php");
  }

ุจุนุฏ:
  return api.get<Type>("/endpoint.php");
```

---

### ุงููุฑุญูุฉ 9: ุฅุถุงูุฉ ูุธุงู ุฅุนุฏุงุฏุงุช ุงููููุน

**ุฌุฏูู MySQL ุฌุฏูุฏ:** `site_settings`
```text
- id VARCHAR(36)
- setting_key VARCHAR(100) UNIQUE
- setting_value TEXT
- updated_at TIMESTAMP
```

**ุงูุจูุงูุงุช ุงูุงูุชุฑุงุถูุฉ:**
```text
- facebook_url
- twitter_url
- instagram_url
- linkedin_url
- phone
- email
- address
```

**ูููุงุช PHP ุฌุฏูุฏุฉ:**
- `php-api/settings/get.php`
- `php-api/settings/update.php`

**ุตูุญุฉ ุฅุฏุงุฑุฉ ุฌุฏูุฏุฉ:**
- `src/pages/admin/SiteSettings.tsx`

**ุชุญุฏูุซ Footer:**
- `src/components/layout/Footer.tsx` - ุฌูุจ ุงูุฅุนุฏุงุฏุงุช ุฏููุงููููุงู

---

### ุงููุฑุญูุฉ 10: ุฅูุดุงุก ุณูุฑูุจุช ุงูุจูุงูุงุช ุงูุฃูููุฉ

**ุงูููู:** `php-api/seed-data.php`

**ุงููุญุชูู:**
```text
1. ุฅูุดุงุก ูุณุชุฎุฏู Admin:
   - username: admin
   - email: admin@aws.sa
   - password: admin123
   - role: admin

2. ุงูููุงุทู (5):
   - ุงููุตููุ ููุฉุ ุงููุฏููุฉุ ุญุงุฆูุ ุนุณูุฑ

3. ุงูุฎุฏูุงุช (6):
   - ุชุนุจุฆุฉ ุงููููุฏุ ุบุณูู ุงูุณูุงุฑุงุชุ ุบูุงุฑ ุงูุฒูุชุ ุณูุจุฑ ูุงุฑูุชุ ูุทุงุนูุ ุตูุฏููุฉ

4. ุงููุญุทุงุช (3 ุชุฌุฑูุจูุฉ):
   - ูุญุทุฉ ุจุฑูุฏุฉุ ูุญุทุฉ ุนููุฒุฉุ ูุญุทุฉ ุฎููุณ ูุดูุท

5. ุฅุนุฏุงุฏุงุช ุงููููุน ุงูุงูุชุฑุงุถูุฉ
```

---

## ุฅุนุฏุงุฏ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ุนูู Hostinger

### ุงูุฎุทูุงุช ุงููุทููุจุฉ ููู:

**1. ุฅูุดุงุก ุญุณุงุจ ุจุฑูุฏ ุนูู Hostinger:**
```text
1. ุงุฏุฎู ููุญุฉ ุชุญูู Hostinger
2. ุงุฐูุจ ุฅูู Emails
3. ุฃูุดุฆ ุญุณุงุจ ุจุฑูุฏ ูุซู: noreply@aws.sa
4. ุงุญูุธ ุจูุงูุงุช ุงูุฏุฎูู
```

**2. ุฅุนุฏุงุฏ ููู config/mail.php:**
```text
ุณุฃูุดุฆ ููู ุฅุนุฏุงุฏุงุช ุงูุจุฑูุฏ
ุชุญุชุงุฌ ูุชุนุจุฆุฉ:
- SMTP_HOST: smtp.hostinger.com
- SMTP_PORT: 465
- SMTP_USER: noreply@aws.sa
- SMTP_PASS: ูููุฉ ูุฑูุฑ ุงูุจุฑูุฏ
```

---

## ูููู ุงููุฌูุฏุงุช ุงูููุงุฆู

```text
public_html/
โโโ api/
โ   โโโ config/
โ   โ   โโโ database.php
โ   โ   โโโ mail.php         โ ุฌุฏูุฏ (ุฅุนุฏุงุฏุงุช ุงูุจุฑูุฏ)
โ   โโโ middleware/
โ   โ   โโโ cors.php
โ   โ   โโโ auth.php
โ   โโโ vendor/               โ ุฌุฏูุฏ (PHPMailer)
โ   โ   โโโ phpmailer/
โ   โโโ auth/
โ   โ   โโโ login.php         โ ุชุนุฏูู (username)
โ   โ   โโโ logout.php
โ   โ   โโโ check-session.php
โ   โ   โโโ change-password.php
โ   โ   โโโ forgot-password.php    โ ุฌุฏูุฏ
โ   โ   โโโ reset-password-verify.php  โ ุฌุฏูุฏ
โ   โโโ settings/             โ ุฌุฏูุฏ
โ   โ   โโโ get.php
โ   โ   โโโ update.php
โ   โโโ hero/
โ   โโโ about/
โ   โโโ services/
โ   โโโ regions/
โ   โโโ stations/
โ   โโโ partners/
โ   โโโ messages/
โ   โโโ users/
โ   โโโ stats/
โ   โโโ upload/
โ   โโโ seed-data.php         โ ุฌุฏูุฏ
โโโ uploads/
โโโ index.html
โโโ assets/
```

---

## ููุฎุต ุงููููุงุช ุงููุชุฃุซุฑุฉ

### ูููุงุช ุชูุนุฏูู:
| ุงูููู | ุงูุชุนุฏูู |
|-------|---------|
| `src/lib/api.ts` | ุฅุฒุงูุฉ USE_SUPABASE |
| `src/pages/AdminLogin.tsx` | ุชุณุฌูู ุฏุฎูู ุจุงุณู ุงููุณุชุฎุฏู |
| `src/pages/ForgotPassword.tsx` | ุงุณุชุฎุฏุงู PHP API |
| `src/pages/ResetPassword.tsx` | ุงุณุชุฎุฏุงู PHP API |
| `src/contexts/AuthContext.tsx` | ุฏุนู username |
| `src/types/api.ts` | ุฅุถุงูุฉ username ููู User |
| `src/components/sections/Hero.tsx` | ุฅุฒุงูุฉ Supabase |
| `src/components/sections/About.tsx` | ุฅุฒุงูุฉ Supabase |
| `src/components/sections/Services.tsx` | ุฅุฒุงูุฉ Supabase |
| `src/components/sections/Stations.tsx` | ุฅุฒุงูุฉ Supabase |
| `src/components/sections/Partners.tsx` | ุฅุฒุงูุฉ Supabase |
| `src/components/sections/Contact.tsx` | ุฅุฒุงูุฉ Supabase |
| `src/components/layout/Footer.tsx` | ุฌูุจ ุฅุนุฏุงุฏุงุช ุฏููุงููููุงู |
| `src/App.tsx` | ุฅุถุงูุฉ route ูู SiteSettings |
| `src/components/admin/AdminLayout.tsx` | ุฅุถุงูุฉ ุฑุงุจุท SiteSettings |
| `php-api/auth/login.php` | ุงูุจุญุซ ุจู username |
| `php-api/database.sql` | ุชุญุฏูุซ ุงููููู |

### ูููุงุช ุฌุฏูุฏุฉ:
| ุงูููู | ุงูุบุฑุถ |
|-------|-------|
| `src/pages/admin/SiteSettings.tsx` | ุตูุญุฉ ุฅุนุฏุงุฏุงุช ุงููููุน |
| `php-api/auth/forgot-password.php` | ุทูุจ ุงุณุชุนุงุฏุฉ ูููุฉ ุงููุฑูุฑ |
| `php-api/auth/reset-password-verify.php` | ุชูููุฐ ุฅุนุงุฏุฉ ุงูุชุนููู |
| `php-api/config/mail.php` | ุฅุนุฏุงุฏุงุช SMTP |
| `php-api/settings/get.php` | ุฌูุจ ุฅุนุฏุงุฏุงุช ุงููููุน |
| `php-api/settings/update.php` | ุชุญุฏูุซ ุฅุนุฏุงุฏุงุช ุงููููุน |
| `php-api/seed-data.php` | ุจูุงูุงุช ุฃูููุฉ |

---

## ุฎุทูุงุช ูุง ุจุนุฏ ุงูุชูููุฐ

### 1. ุฅุนุฏุงุฏ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู:
```text
1. ุฃูุดุฆ ุญุณุงุจ noreply@aws.sa ูู Hostinger
2. ุนุฏูู ููู config/mail.php ุจุจูุงูุงุช SMTP
```

### 2. ุฑูุน PHPMailer:
```text
1. ุญููู PHPMailer ูู GitHub
2. ุงุฑูุนู ูู api/vendor/phpmailer/
```

### 3. ุชุดุบูู ุณูุฑูุจุช ุงูุจูุงูุงุช:
```text
1. ุงูุชุญ https://aws.sa/api/seed-data.php
2. ุงูุชุธุฑ ุฑุณุงูุฉ ุงููุฌุงุญ
3. ุงุญุฐู ุงูููู ุจุนุฏ ุงูุชุดุบูู
```

### 4. ุงุฎุชุจุงุฑ ุงููุธุงู:
```text
1. ุณุฌู ุฏุฎูู ุจู admin / admin123
2. ุบููุฑ ูููุฉ ุงููุฑูุฑ ููุฑุงู
3. ุงุฎุชุจุฑ ุงุณุชุนุงุฏุฉ ูููุฉ ุงููุฑูุฑ
```

---

## ุจูุงูุงุช ุงูุฏุฎูู ุงูุงูุชุฑุงุถูุฉ

```text
ุงุณู ุงููุณุชุฎุฏู: admin
ูููุฉ ุงููุฑูุฑ: admin123
ุงูุจุฑูุฏ (ูุงุณุชุนุงุฏุฉ ูููุฉ ุงููุฑูุฑ): admin@aws.sa
```

**ุชูุจูู ุฃููู:** ุบููุฑ ูููุฉ ุงููุฑูุฑ ููุฑุงู ุจุนุฏ ุฃูู ุชุณุฌูู ุฏุฎูู!
